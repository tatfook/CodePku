<!-- "script/apps/Aries/Creator/Game/Areas/SystemEntrencePage.html" -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
</head>
<body>
    <pe:mcml>
<script refresh="false" type="text/npl" src="TopicEntrence.lua"><![CDATA[
TopicEntrencePage = commonlib.gettable("MyCompany.Aries.Creator.Game.Desktop.TopicEntrencePage");
MainEntrencePage = commonlib.gettable("MyCompany.Aries.Creator.Game.Desktop.MainEntrencePage");
TopicEntrencePage.OnInit()


local last_clicked_index = 1
local last_navig_clicked_index = 1
local page_num = 1

local subjects = {
    [1] = {name='推荐', title='reco', index=1, subject_id=2},
    [2] = {name='语文', title='chinese', index=2, subject_id=1},
    [3] = {name='数学', title='math', index=3, subject_id=2},
    [4] = {name='英语', title='english', index=4, subject_id=3},
    [5] = {name='物理', title='physics', index=5, subject_id=4},
    [6] = {name='化学', title='chemestry', index=6, subject_id=5},
    [7] = {name='生物', title='biology', index=7, subject_id=6},
}
local navig = {
    [1] = {name="古诗", title="gushi", index=1},
    [2] = {name="文章", title="wenzhang", index=2},
    [3] = {name="诗词", title="shici", index=3},
    [4] = {name="名言", title="mingyan", index=4},
    [5] = {name="其他", title="qita", index=5},
}
local topic_course = {
    [1] = {img = "https://scratch-works-staging-1253386414.file.myqcloud.com/game/admin/courseUnitCover/da76db9593ccaf73fd42939713750b10.png", name = "1", id = 1},
    [2] = {img = "https://scratch-works-staging-1253386414.file.myqcloud.com/game/admin/courseUnitCover/da76db9593ccaf73fd42939713750b10.png", name = "2", id = 2},
    [3] = {img = "https://scratch-works-staging-1253386414.file.myqcloud.com/game/admin/courseUnitCover/da76db9593ccaf73fd42939713750b10.png", name = "3", id = 3},
    [4] = {img = "https://scratch-works-staging-1253386414.file.myqcloud.com/game/admin/courseUnitCover/da76db9593ccaf73fd42939713750b10.png", name = "4", id = 4},
    [5] = {img = "https://scratch-works-staging-1253386414.file.myqcloud.com/game/admin/courseUnitCover/da76db9593ccaf73fd42939713750b10.png", name = "5", id = 5},
    [6] = {img = "https://scratch-works-staging-1253386414.file.myqcloud.com/game/admin/courseUnitCover/da76db9593ccaf73fd42939713750b10.png", name = "6", id = 6},
    [7] = {img = "https://scratch-works-staging-1253386414.file.myqcloud.com/game/admin/courseUnitCover/da76db9593ccaf73fd42939713750b10.png", name = "7", id = 7},
}

function ClosePage()
    Page:CloseWindow();
    
end

function OnClose()
    ClosePage()
    MainEntrencePage.ShowPage()
end

function GetSubjects()
    return subjects
end

function GetNavig()
    return navig
end

function get_topic_course()
    course = TopicEntrencePage.GetCourse(subjects[last_clicked_index].subject_id)
    return course
end

function OnClickSubject(name)
    subjects[name].title = subjects[name].title..'_clicked'
    subjects[last_clicked_index].title = string.gsub(subjects[last_clicked_index].title, '_clicked', '')
    last_clicked_index = name
    Page:Refresh(0)
end

function ChangeTopicPage(name)
    if name == 'page_left' and page_num > 1 then
        page_num = page_num - 1
        Page:Refresh(0)
    elseif name == 'page_right' and #topic_course > page_num*6 then
        page_num = page_num + 1
        Page:Refresh(0)
    end
end

function OnClickNavig(name)

end

function OnClickCourse(name)
    GameLogic.RunCommand(string.format("/connectCodePku %d", name));
end


]]></script>
<style type="text/mcss">
{
    Navig_button = {
        color = "#ffffff",
        textcolor = "#000000",
        width = 120,
        height = 30,
        ["font-size"] = 50,
        ["base-font-size"] = 50,
        border = "none",
        ["font-weight"] = "bold",
        ["font-family"] = "Microsoft Yahei",
        ["margin-top"] = 10
    },
    content_detail = {
        ["margin-top"] = 50,
        ["margin-left"] = 100,
        width = 700,
        height = 150
    },
    detail_text = {
        width = 300,
        height = 50,
        ["margin-top"] = 30,
        ["margin-left"] = 20
    }
}
</style>

<div style="margin-top:5px;width:1920;height: 1080;background:url(codepku/image/textures/fastentrence/topic_board.png)">
    <div style='width:100px;height:100px;background:url(codepku/image/textures/fastentrence/return.png);margin-left: 100px;margin-top: 20px;' onclick="OnClose"></div>
    <div style="width:200px;height:800px;margin-left: 20px;margin-right: 20px;margin-top:70px;float: left;">
        <pe:repeat DataSource="<%=GetSubjects()%>">
            <pe:repeatitem>
                <div style="<%=format('background:url(codepku/image/textures/fastentrence/topic/%s.png);width:220;height:100;margin-left:-18;margin-bottom: 30;', Eval('title'))%>" name='<%=Eval("index")%>' onclick='OnClickSubject'></div>
            </pe:repeatitem>
        </pe:repeat>
    </div>
    <div style="width:1630px;height:770px;margin-left: 20px;margin-top:50px;float: left;">
        <div style="width: 650px;height: 50px;margin-top: 40px;">
            
        </div>
        <div style="width: 1630px;height: 675px;">
            <pe:repeat DataSource="<%=get_topic_course()%>">
                <pe:repeatitem>
                    <div class="content_detail" style="float: left;" name="<%=Eval('id')%>" onclick="OnClickCourse">
                        <div style="width: 280px; height: 140px; margin-top:15px;background: url(codepku/image/textures/fastentrence/topic/content_image.png);float: left;">
                            <img src="<%=Eval('img')%>" style="width:250px; height: 130px; margin-left: 15px;"/>
                        </div>
                        <div style="width: 420px; height: 120px; margin-top:15px;background: url(codepku/image/textures/fastentrence/topic/content_detail.png);float: left;">
                            <div style="margin-top: 20px;margin-left: 30px;font-size: 20px;"><%=Eval('name')%></div>
                            <div style="margin-top: 20px;margin-left: 30px;font-size: 20px;"><%=Eval('id')%></div>
                        </div>
                    </div>
                </pe:repeatitem>
            </pe:repeat>
        </div>
        <div style="width: 1630px; height: 100px; text-align: center;">
            <div style="background:url(codepku/image/textures/fastentrence/prev.png);width: 100px; height: 100px;float: left; margin-left:700" name="page_left" onclick="ChangeTopicPage">
                <img src="codepku/image/textures/fastentrence/topic/page_left.png" style="width: 50px; height: 50px;float: left;"/>
            </div>
            <div style="width: 100px; height: 100px;float: left; margin-left:800;margin-top:-70;font-size: 40px;base-font-size:40px;"><%=page_num%></div>
            <div style="background:url(codepku/image/textures/fastentrence/next.png);width: 100px; height: 100px;float: left;margin-left:900;margin-top:-130" name="page_right" onclick="ChangeTopicPage">
                <img src="codepku/image/textures/fastentrence/topic/page_right.png" style="width: 50px; height: 50px;float: left;"/>
            </div>
        </div>
    </div>
</div>


</pe:mcml>
</body>
</html>
