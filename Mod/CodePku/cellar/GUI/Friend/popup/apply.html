<!-- "Mod/CodePku/cellar/Gui/FriendUI/MyFriend.html" -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
</head>

<body>
<pe:mcml>
<script refresh="false" type="text/npl" src="FriendUI.lua">
<![CDATA[
local FriendUI = commonlib.gettable("Mod.CodePku.GUI.FriendUI")

function getFriendData()
    return FriendUI.vars["apply"] or {};
end

function ClosePage()
    Page:CloseWindow();
end


function ClickAgree(aid)
    res = FriendUI:HandleApply(aid, 1)
    if(res) then
        FriendUI:GetApply()
        Page:Refresh(0);
    end
end

function ClickRefuse(aid)
    FriendUI:HandleApply(aid, 2)
    if(res) then
        FriendUI:GetApply()
        Page:Refresh(0);
    end
end

function ClickBlacklist(fid)
    res = FriendUI:block(fid)
    if(res) then
        FriendUI:GetApply()
        Page:Refresh(0);
    end
end

]]>
</script>

<div style="width:1020;height: 550;margin-left:450;margin-top:265;background: url(codepku/image/textures/friend/main/popup.png)">
    <!--title-->
    <div style="position:relative; left:160;top:45;width: 192;height:50;background: url(codepku/image/textures/friend/main/apply_title.png);"></div>
    <div style="position:relative; margin-left: 900;width: 50;height: 50;margin-top: 40;background: url(codepku/image/textures/friend/main/close.png);" onclick="ClosePage"></div>
    <!--context-->
    <pe:gridview name="MyFriend" style="position:relative;margin-top:190;margin-left: 50;
height:280;width: 920;background-color: #ff00ff50;" DataSource='<%=getFriendData() %>' CellPadding="10" ItemsPerLine="1" AllowPaging="false" RememberScrollPos="true" RememberLastPage="true">
    <Columns>
        <div style="width: 850;height: 130;">
            <pe:div style="position:relative; width:850; height:130; margin-left: 20; background: url(codepku/image/textures/friend/friend_apply/item_bg.png);"></pe:div>
            <pe:div style="position:relative; width:110; height:110; margin-top: 10; margin-left: 40; background: url(codepku/image/textures/friend/friend_apply/item_head.png);"></pe:div>
            <pe:div style='<%=format("position:relative; width:90; height:90; left: 55;top: 20;background: url(%s);", Eval("head"))%>'></pe:div>
            <div style="position:relative; left: 170; top: 10; ">
                <div style="height:40; font-size: 40;float: left; color: #ffffff;"><%=Eval("nickname")%></div>
                <pe:if condition='<%=Eval("gender") ~=0%>'>
                    <div style='<%=format("width:37; height:37; top: 2; left: 20; float: left; background: url(codepku/image/textures/friend/item/%s.png);", Eval("gender"))%>'></div>
                </pe:if>
            </div>
            <pe:if condition="<%=Eval('is_online') == true%>">
                <div style="position:relative; width:250; height:30; left:170;top:50;font-size: 26;color: #00ff22;">在线</div>
            </pe:if>
            <pe:if condition="<%=Eval('is_online') == false%>">
                <div style="position:relative; width:250; height:30; left:170;top:50;font-size: 26;color: #f13709;">离线</div>
            </pe:if>
            <div style="position:relative; width:250; height:30; left:170;top:80;font-size: 26;color: #FFFFFF;">ID: <%=Eval("friend_id")%></div>
            
            <pe:div style="position:relative;width:70;height:45;top:45;left:520;background: url(codepku/image/textures/friend/friend_apply/refuse.png);" name='<%=Eval("id")%>' onclick="ClickRefuse"></pe:div>
            <pe:div style="position:relative;width:70;height:45;top:45;left:640;background: url(codepku/image/textures/friend/friend_apply/agree.png);" name='<%=Eval("id")%>' onclick="ClickAgree"></pe:div>
            <pe:div style="position:relative;width:70;height:45;top:45;left:760;background: url(codepku/image/textures/friend/friend_apply/blacklist.png);" name='<%=Eval("friend_id")%>' onclick="ClickBlacklist"></pe:div>
                
        </div>
    </Columns>
    </pe:gridview>

</div>
</pe:mcml>
</body>

</html>