<!-- "Mod/CodePku/cellar/Gui/FriendUI/MyFriend.html" -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
</head>

<body>
<pe:mcml>
<script refresh="false" type="text/npl" src="FriendUI.lua">
<![CDATA[
local FriendUI = NPL.load("(gl)Mod/CodePku/cellar/GUI/Friend/FriendUI.lua")
cur_index = 1
menu = {
    {index = 1, text = "my_friend"},
    {index = 2, text = "recent_player"},
    {index = 3, text = "black_list"},
}

function ClosePage()
    Page:CloseWindow();
end


function ChangePage(index)
    FriendUI:ShowPage(index)
end


function ClickChat(uid)
    echo("chat")
end

function ClickDelete(uid)
    echo("delete")
end


function getFriendData()
    return FriendUI.vars["friends"] or {}
end

function AddFriend()
    FriendUI:ShowPopup(1)
end

function FriendApply()
    FriendUI:GetApply()
    FriendUI:ShowPopup(3)
end

function ClickDelete(lindex)
    data = getFriendData()
    FriendUI.vars["cur"] = data[lindex]
    FriendUI:ShowPopup(4)
end

]]>
</script>
<style type="text/mcss">

</style>
<pe:container alignment="_ct" left="-960" top="-540" width="1920" height="1080" style="background: url(codepku/image/textures/friend/main/bg.png)">
    <div style="position:relative; width: 164;height: 83;left:170;top:20;
    background: url(codepku/image/textures/friend/main/title.png);">
    </div>
    <div style="position:relative; margin-left: 40;width: 100;height: 60;margin-top: 35;
    background: url(codepku/image/textures/friend/main/return.png);" onclick="ClosePage"></div>

    <input type="button" style="position:relative; margin-left: 450;margin-top: 140;width: 225;height: 70;
    background: url(codepku/image/textures/friend/main/add_friend.png);" onclick="AddFriend" />
    <input type="button" style="position:relative; margin-left: 1600;margin-top: 140;width: 225;height: 70;
    background: url(codepku/image/textures/friend/main/friend_apply.png);" onclick="FriendApply" />

    <!-- left bar menu -->
    <pe:repeat DataSource="<%=menu%>" style="position:relative;top:235">
        <pe:repeatitem>
            <pe:if condition='<%=Eval("index") ~= cur_index%>'>
            <div style='<%=format("width:275; height:107;left: 67;margin-top:30;background: url(codepku/image/textures/friend/menu/%s.png);",
            Eval("text"))%>' name='<%=Eval("index")%>' onclick="ChangePage"></div>
            </pe:if>
            <pe:if condition='<%=Eval("index") == cur_index%>'>
            <div style='<%=format("width:294; height:107;left: 48;margin-top:30;background: url(codepku/image/textures/friend/menu/%s.png);",
            Eval("text").."_active")%>'></div>
            </pe:if>
        </pe:repeatitem>
    </pe:repeat>

    <div style="position:relative;margin-top:250;margin-left: 1800;font-size: 30;color:#ffffff"><%=#getFriendData()%>/50</div>

    <pe:gridview name="MyFriend" style="position:relative;margin-top:300;margin-left: 400;
    height:700;background-color: #ff00ff50;" DataSource='<%=getFriendData() %>' CellPadding="10" ItemsPerLine="1" AllowPaging="false" RememberScrollPos="true" RememberLastPage="true" 
    VerticalScrollBarStep="36" VerticalScrollBarOffsetX="8">
    <Columns>
    <div style="width: 1440;height: 160;">
        <div style="position:relative;width:1423;height:140;top:15;left:15;background: url(codepku/image/textures/friend/item/bg.png);"></div>
        <div style="position:relative;width:160;height:160;background: url(codepku/image/textures/friend/item/head.png);"></div>
        <div style='<%=format("position:relative;width:120;height:120;left: 20;top: 20;background: url(%s);", Eval("head"))%>'></div>

        <div style="position:relative; left: 200; top: 20; ">
            <div style="height:40; font-size: 40;float: left; color: #FFA500;"><%=Eval("nickname")%></div>
            <pe:if condition='<%=Eval("gender") ~=0%>'>
                <div style='<%=format("width:37; height:37; top: 3; left: 20; float: left; background: url(codepku/image/textures/friend/item/%s.png);", Eval("gender"))%>'></div>
            </pe:if>
        </div>

        <div style="position:relative;width:200;height:40;left:200;top:100;font-size: 30;color: #FFA500;">ID: <%=Eval("no")%></div>

        <pe:if condition="<%=Eval('is_online') == true%>">
                <div style="position:relative; width:250; height:30; left:700;top:60;font-size: 40;color: #00ff22;">在线</div>
            </pe:if>
        <pe:if condition="<%=Eval('is_online') == false%>">
            <div style="position:relative; width:250; height:30; left:700;top:60;font-size: 40;color: #f13709;">离线</div>
        </pe:if>

        <div style="position:relative;width:100;height:60;top:50;left:1120;background: url(codepku/image/textures/friend/my_friend/delete.png);" name='<%=Eval("index")%>' onclick="ClickDelete"></div>
        <div style="position:relative;width:100;height:60;top:50;left:1260;background: url(codepku/image/textures/friend/my_friend/chat.png);" name='<%=Eval("index")%>' onclick="ClickChat"></div>
    </div>
    </Columns>
    </pe:gridview>


</pe:container>
</pe:mcml>
</body>

</html>