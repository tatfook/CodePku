<!-- "Mod/CodePku/cellar/Common/TouchMiniButtons/MainUIButtons_dialog.html" -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
</head>

<body>
<pe:mcml>
<script refresh="false" type="text/npl" src="MainSceneUIButtons.lua"><![CDATA[
MainSceneUIButtons = commonlib.gettable("Mod.CodePku.Common.TouchMiniButtons.MainSceneUIButtons");
DialogMessages = commonlib.gettable("Mod.CodePku.Common.MainUIButtons.DialogMessages")
MessageTopics = {"全部","世界","本地","公会","私聊","系统"}
MessageColors = {"#FFFFFF","#00F5FF","#D3D3D3","#7FFF00","#EEB4B4","#FF0000"}
DialogMessages[1] = {
    kind = 3,
    sender = "会飞的鱼",
    text = "一二三四五"
}
DialogMessages[2] = {
    kind = 6,
    sender = "System",
    text = "一一一一一二二二二二三三三三三四四四四四五五五五五"
}
DialogMessages[3] = {
    kind = 2,
    sender = "好大的鱼",
    text = "六七八九十"
}
DialogMessages[4] = {
    kind = 5,
    sender = "虎纹鲨鱼",
    text = "二二二二二"
}
DialogMessages[5] = {
    kind = 4,
    sender = "不飞的鱼",
    text = "666666"
}

is_dialog_open = false
categories = {{index=1, text="全部"},{index=2, text="世界"},{index=3, text="本地"},{index=4, text="公会"},{index=5, text="私聊"}}

function GetCategories()
    return categories;
end


function GetDialogMessages()
    return DialogMessages
end

function ClickClose() 
    Page:CloseWindow();
    MainSceneUIButtons.show_dialog_ui(false)
end

]]></script>
<style type="text/mcss">
</style>
<pe:container alignment="_lb" width="400" height="350" style="background: none;">
        <div style="width:400;height:350;background-color: #00000050;">

        <div style="font-size: 24;base-font-size:24; height: 40;">
            <pe:repeat DataSource="<%=GetCategories()%>">
                <pe:repeatitem>
                     <div style='<%=format("position:relative; width:55; height:35;line-height:30;text-align:center;left: %s;top:0;background-color: #ffff00;", Eval("index") * 60 - 45)%>'><%=Eval("text")%></div>
                </pe:repeatitem>
            </pe:repeat>
            <div style="position:relative;left:350;width:50; height:50; background: url(codepku/image/textures/mainuibuttons/dialog/close_button.png);" onclick="ClickClose"></div>
        </div>
        <div style="font-size: 24;base-font-size:24;left:15">
            <pe:repeat DataSource="<%=GetDialogMessages()%>">
                <pe:repeatitem>
                    <pe:if condition='<%=Eval("kind") ~= 6%>'>
                    <div style='<%=format("width:370; line-height:35;word-wrap:break-word;color:%s", MessageColors[Eval("kind")])%>'>
                    <%=format("【%s】%s: %s", MessageTopics[Eval("kind")], Eval("sender"), Eval("text"))%>
                    </div>
                    </pe:if>
                    <pe:if condition='<%= Eval("kind") == 6 %>'>
                    <div style='<%=format("width:370; line-height:35;word-wrap:break-word;color:%s", MessageColors[Eval("kind")])%>'>
                        <%=format("【%s】 %s", MessageTopics[Eval("kind")], Eval("text"))%>
                    </div>
                    </pe:if>
                </pe:repeatitem>
            </pe:repeat>
        </div>
        </div>

</pe:container>
</pe:mcml> 
</body>
</html>