<!-- "Mod/CodePku/cellar/Common/TouchMiniButtons/MainUIButtons_interact.html" -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
</head>

<body>
<pe:mcml>
<script refresh="false" type="text/npl" src="MainSceneUIButtons.lua"><![CDATA[
NPL.load("(gl)script/apps/Aries.Creator.Game.Desktop.OtherUserInfos.lua");
UserInfoPage = commonlib.gettable("Mod.CodePku.OtherUserInfoPage")
NPL.load("(gl)Mod/CodePku/cellar/GUI/Friend/FriendUI.lua");
FriendUI = NPL.load("(gl)Mod/CodePku/cellar/GUI/Friend/FriendUI.lua")
size = 400
name = Page:GetRequestParam("pname")
pid = Page:GetRequestParam("pid")
ppid = pid

echo("2222222222222222222222222")
echo(name)

function CheckFriend()
    FriendUI:GetFriend()
    fdatas = FriendUI.vars["friends"] or {}
    for fi, fdata in ipairs(fdatas) do

        if "_"..fdata.friend_id == "_"..pid then
            ppid = fdata.id 
            return true
        end
    end
    return false
end

is_friend = CheckFriend()


function CloseInteract()
    Page:CloseWindow();
end

function ClickSeeInfo()
    UserInfoPage:ShowPage(pid)
    Page:CloseWindow();
end

function ClickChat()
    GameLogic.AddBBS("CodeGlobals", L"功能开发中", 3000, "#ff0000");
end

function ClickEmail()
    GameLogic.AddBBS("CodeGlobals", L"功能开发中", 3000, "#ff0000");
end

function ClickAddFriend()
    FriendUI.vars["search"] = {nickname=name}
    FriendUI:Add_Friend(pid)
end

function ClickDelFriend()
    FriendUI.vars["cur"] = {nickname=name}
    FriendUI:DeleteFriend(ppid)
    is_friend = CheckFriend()
    Page:Refresh(0)
end


]]></script>
<style type="text/mcss">
</style>
<pe:container alignment="_lt" width="1920" height="1080">
    <div style = '<%=format("position: relative;width:1920;height:%s;", (1080-size)/2)%>' onclick="CloseInteract"></div>
    <div style = '<%=format("position: relative;width:%s;height:%s;top:%s;", (1920-size)/2,size,(1080-size)/2)%>' onclick="CloseInteract"></div>
    <div style = '<%=format("position: relative;background:url(codepku/image/textures/mainuibuttons/interact/roulette.png);width:%s;height:%s;top:%s;left:%s;", size,size,(1080-size)/2, (1920-size)/2)%>'>
        <div style="position:relative; width:100;height:100;margin-left:150;margin-top:5;">
            <input type="button" style="width:70;height:70;margin-left:15;background:url(codepku/image/textures/mainuibuttons/interact/see_info.png);" onclick="ClickSeeInfo" />
            <div style="width:100;height:20;text-align: center;font-size: 22px;base-font-size: 22px;">查看信息</div>
        </div>
        
        <pe:if condition='<%= not is_friend%>'>
            <div style="position:relative; width:100;height:100;margin-left:5;margin-top:150;">
                <input type="button" style="width:70;height:70;margin-left:15;background:url(codepku/image/textures/mainuibuttons/interact/add_friend.png);" onclick="ClickAddFriend" />
                <div style="width:100;height:20;text-align: center;font-size: 22px;base-font-size: 22px;">添加好友</div>
            </div>
        </pe:if>
        <pe:if condition='<%=is_friend%>'>
            <div style="position:relative; width:100;height:100;margin-left:5;margin-top:150;">
                <input type="button" style="width:70;height:70;margin-left:15;background:url(codepku/image/textures/mainuibuttons/interact/del_friend.png);" onclick="ClickDelFriend" />
                <div style="width:100;height:20;text-align: center;font-size: 22px;base-font-size: 22px;">删除好友</div>
            </div>
        </pe:if>
        <div style="position:relative; width:100;height:100;margin-left:295;margin-top:150;">
            <input type="button" style="width:70;height:70;margin-left:15;background:url(codepku/image/textures/mainuibuttons/interact/chat.png);" onclick="ClickChat" />
            <div style="width:100;height:20;text-align: center;font-size: 22px;base-font-size: 22px;">私聊</div>
        </div>
        <div style="position:relative; width:100;height:100;margin-left:150;margin-top:295;">
            <input type="button" style="width:70;height:70;margin-left:15;background:url(codepku/image/textures/mainuibuttons/interact/email.png);" onclick="ClickEmail" />
            <div style="width:100;height:20;text-align: center;font-size: 22px;base-font-size: 22px;">邮件</div>
        </div>

        <div style="position:relative; width:100;height:100;left:150;top:120;background:url(codepku/image/textures/mainuibuttons/interact/head.png);"></div>
        <div style="position:relative; width:180;height:120;left:110;top:230;font-size: 22px;base-font-size:22px;text-align:center;"><%=name%></div>

    </div>
    <div style = '<%=format("position: relative;width:%s;height:%s;top:%s;left:%s;", (1920-size)/2,size,(1080-size)/2, (1920+size)/2)%>' onclick="CloseInteract"></div>
    <div style = '<%=format("position: relative;width:1920;height:%s;top:%s;", (1080-size)/2, (1080+size)/2)%>' onclick="CloseInteract"></div>


</pe:container>
</pe:mcml> 
</body>
</html>